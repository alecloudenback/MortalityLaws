---
title: "MortalityLaws R package"
author: "Marius Pascariu"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette --- MortalityLaws R package}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---


`MortalityLaws` in an R package which exploits the available optimization methods to provide tools for fitting and analyzing a wide range of mortality models. 

Three main functions are available in the package: `ReadHMD`, `MortalityLaw`, `LifeTable` and `convertFx`. The package provides also generic functions like `summary`, `plot`, `coef`, `fitted.values` and a small data set for testing purposes `ahmd`.


## The structure of the MoralityLaws R package

```{r echo = FALSE, message = FALSE, fig.height = 4.5, fig.width = 7, fig.pos = 'H'}
library(diagram)

names <- c('MortalityLaws\n R package', 
           'ReadHMD()', 'MortalityLaw()', 'LifeTable()', 'convertFx()',
          'summary()', 'coef()','fitted.values()', 'plot()')

M <- matrix(nrow = 9, ncol = 9, byrow = TRUE, 
           data = c(# M hmd, r  m   l  p  s  p
                      0, 0, 0, 0,  0, 0, 0, 0, 0, #H
                      1, 0, 0, 0,  0, 0, 0, 0, 0, #hmd
                      2, 0, 0, 0,  0, 0, 0, 0, 0, #read
                      2, 0, 0, 0,  0, 0, 0, 0, 0, #Ml
                      2, 0, 0, 0,  0, 0, 0, 0, 0, #life
                      0, 0, 3, 0,  0, 0, 0, 0, 0, #summary
                      0, 0, 3, 0,  0, 0, 0, 0, 0, #coef
                      0, 0, 3, 0,  0, 0, 0, 0, 0, #fitted
                      0, 0, 3, 0,  0, 0, 0, 0, 0  #plot
                    ))

par(mar = c(0.1, 0.1, 0.1, 0.1))
plotmat(M, pos = c(1, 4, 4), curve = 0, name = names,
        lwd = 1, box.lwd = 2, cex.txt = 0,
        box.type = "square", box.prop = 0.4, arr.type = "triangle",
        arr.pos = 0.6, shadow.size = 0.01, prefix = "f",
        main = "")
```

All functions are documented in the standard way, which means that once you load the package you can just type for example `?MortalityLaw` to see the help file for `MortalityLaw` function.

## Installation
`MortalityLaws` is a software in development. The repository containing the development version of the package can be found on [GitHub](https://github.com/mpascariu/MortalityLaws) and can be installed by running the following code in the R console:

```{r echo=TRUE, eval=FALSE}
# Make sure you have the most recent version of R and devtools package already installed.
# install.packages("devtools")
devtools::install_github("mpascariu/MortalityLaws")
```

The package is loaded within **R** as follows: 

```{r echo=TRUE, eval=FALSE}
library(MortalityLaws)
```


## Download HMD Data 
Download data form [Human Mortality Database](http://www.mortality.org) using the `ReadHMD` function:
 
```{r echo=TRUE, eval=FALSE}
# Download HMD data - death counts
HMD_Dx <- ReadHMD(what = "Dx",
                  countries = "SWE",  # HMD country code for Sweden
                  interval = "1x1",            # 1 year - 1 age data
                  username = "user@email.com", # here add your HMD username 
                  password = "password",       # here add your password account
                  save = FALSE)                # Do you what to save the data outside R
```
Here we have downloaded all the registered death counts in Sweden from 1751 until 2014. In the same way one can download the following records: birth counts, population size, lexis triangles, exposures, life tables, life expectancy at birth and death rates for over 38 countries and regions in different formats.


Download life tables all Swedish life tables for female population and save them in an external object:
```{r echo=TRUE, eval=FALSE}
HMD_Ex <- ReadHMD(what = "LT_f", 
                  countries = "SWE", 
                  interval = "1x1", 
                  username = "user@email.com", 
                  password = "password", 
                  save = TRUE)
```











