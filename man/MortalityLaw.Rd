% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fun_Fit.R
\name{MortalityLaw}
\alias{MortalityLaw}
\title{Fit mortality law}
\usage{
MortalityLaw(x, mx = NULL, qx = NULL, Dx = NULL, Ex = NULL, law,
  how = "poissonL", parS = NULL, fit.this.x = x, custom.law = NULL, ...)
}
\arguments{
\item{x}{Vector of ages}

\item{mx}{Vector of age-specific death rates}

\item{qx}{Vector of age-specific probabilities of death}

\item{Dx}{Vector containing death counts}

\item{Ex}{Vector containing the exposed population}

\item{law}{The name of the mortality law/model to be fitted. eg. \code{gompertz}, 
\code{makeham}, ...}

\item{how}{How would you like to find the parameters? Specify the function 
to be optimize. Available options: the Poisson likelihood function 
\code{poissonL}; the Binomial likelihood function -\code{binomialL}; 
Least absolute errors \code{LAE};
and Least square errors \code{LSE}.}

\item{parS}{Starting parameters used in optimization process (optional)}

\item{fit.this.x}{select the ages to be cosidered in model fitting. By default 
fit.this.x = x. One may want exculde from the fitting procedure say the 
advance ages were the data is sparse.}

\item{custom.law}{This argument allows you to fit a model that is not defined 
in the package. Accepts as input a function.}

\item{...}{Other argumnets}
}
\value{
A \code{MortalityLaw} object
}
\description{
This function can be used to fit mortality models given a set of data. 
Using the argument \code{law} one can specify the model to be fitted. 
So far there are more than 20 parametric model implemented.
}
\examples{
library(MortalityLaws)

yr <- 1950
ages  <- 35:75
Dx <- ahmd$Dx[paste(ages), paste(yr)]
Ex <- ahmd$Nx[paste(ages), paste(yr)]
mx <- ahmd$mx[paste(ages), paste(yr)]

# Fit Makeham model
model1 <- MortalityLaw(x = ages, Dx = Dx, Ex = Ex, law = 'makeham')

model1
ls(model1)
summary(model1)
plot(model1)

# we can fit the same model using diffrent data and a different optimization procedure
model1.1 <- MortalityLaw(x = ages, mx = mx, law = 'makeham', how = 'LF1')

#---------------------------------------
# Now let's fit a mortality law that is not defined in the package, say a
# reparametrize Gompertz in terms of modal age at death
# hx = b*exp(b*(x-m))  (here b and m are the parameters to be estimated)

my_gompertz <- function(x, par = c(b = 0.13, m = 45)){
  hx  <- with(as.list(par), b*exp(b*(x - m)) )
  return(as.list(environment())) # return everything inside this function
}

model2 <- MortalityLaw(x = ages, Dx = Dx, Ex = Ex, custom.law = my_gompertz)
summary(model2)
plot(model2)

}
